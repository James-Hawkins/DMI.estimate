setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library('readxl')
library('ggplot2')
library('dplyr')
library('ggpubr')
library('stringi')
library('stringr')
d <<- read_excel('feed_intake_data+JH.xlsx'
, sheet = 'feed_intake_raw'
, col_types = "text")
na.value <- 'NA'
unq.spcs <- unique(d$Species)
unq.brdss <- unique(d$Variety)
species.cattle <- c(   unq.spcs[3], unq.spcs[9]  )
d <- d[  d$Species %in% species.cattle  , ]
d <- data.frame(d)
length(unique(d[, 'B.Code']))
length(unique(d[  d$bw_kg != na.value , 'B.Code']))
length(unique(d[  d$bw_kg != na.value & d$feed_intake_value != na.value & d$milk_kg_day == na.value, 'B.Code']))
colnames(d)
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day == na.value
& d$NDF_nutrition != na.value
& d$DM_digest != na.value
, length(unique(d[  d$bw_kg != na.value & d$feed_intake_value != na.value & d$milk_kg_day == na.value , 'B.Code']))]))
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day == na.value
& d$NDF_nutrition != na.value
& d$DM_digest != na.value
, ]))
colnames(d)
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day == na.value
& d$NDF_nutrition != na.value
& d$DM_digest != na.value
, "A.Level.Name"]))
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day == na.value
& d$NDF_nutrition != na.value
# & d$DM_digest != na.value
, "A.Level.Name"]))
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day == na.value
# & d$NDF_nutrition != na.value
& d$DM_digest != na.value
, "A.Level.Name"]))
length(unique(d[
d$bw_kg != na.value
& d$feed_intake_value != na.value
& d$milk_kg_day != na.value
# & d$NDF_nutrition != na.value
& d$DM_digest != na.value
, "A.Level.Name"]))
# Breed indicus
breeds.indicus <- unq.brdss[!(unq.brdss %in% breeds.dairy) ]
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
# Breed indicus
breeds.indicus <- unq.brdss[!(unq.brdss %in% breeds.dairy) ]
zebu <- d[d$Variety %in% breeds.indicus , ]
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
zebu <- d[d$Variety %in% breeds.indicus , ]
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
# Breed indicus
breeds.indicus <- unq.brdss[!(unq.brdss %in% breeds.dairy) ]
zebu <- d[d$Variety %in% breeds.indicus , ]
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
zebu$bw_kg
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$DM_digest != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$DM_digest != na.value  , ]
length(unique(dairy$B.Code))
dairy$bw_kg
dairy$milk_kg_day
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- d[d$Variety %in% breeds.indicus , ]
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu$adg_g_day
zebu <- d[d$Variety %in% breeds.indicus , ]
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu <- zebu[zebu$NDF_nutrition != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu$CP_nutrition
zebu <- zebu[zebu$CP_nutrition != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu$bw_kg
zebu$CP_nutrition
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
zebu$adg_g_day
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- zebu[zebu$DM_digest != na.value  , ]
length(unique(zebu$B.Code))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu <- zebu[zebu$NDF_nutrition != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu$CP_nutrition
zebu$NDF_nutrition
zebu <- zebu[zebu$NDF_nutrition != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu <- zebu[zebu$NDF_nutrition != na.value  , ]
zebu$adg_g_day
zebu$milk_kg_day
zebu$bw_kg
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu$CP_nutrition
zebu <- zebu[zebu$NDF_nutrition != na.value  , ]
zebu$bw_kg
# SUbsetting based on nutrition
zebu <- zebu[zebu$DM_digest != na.value  , ]
zebu <- d[d$Variety %in% breeds.indicus , ]
zebu <- zebu[zebu$CP_nutrition != na.value  , ]
# Subsetting based on physiology
zebu <- zebu[  zebu$bw_kg != 'NA'  , ]
zebu <- zebu[  zebu$milk_kg_day != 'NA'  , ]
zebu <- zebu[  zebu$adg_g_day != 'NA'  , ]
length(unique(zebu$B.Code))
length(unique(zebu$A.Level.Name))
zebu$milk_kg_day
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$NDF_nutrition != na.value  , ]
dairy <- dairy[dairy$CP_nutrition != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$CP_nutrition != na.value  , ]
dairy <- dairy[dairy$NDF_nutrition != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$NDF_nutrition != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
dairy$B.Code
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy$NDF_nutrition
dairy <- dairy[dairy$NDF_nutrition != na.value  , ]
dairy <- dairy[  dairy$milk_kg_day != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
dairy$CP_nutrition
dairy$NDF_nutrition
dairy$bw_kg
dairy$milk_kg_day
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$DM_digest != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$DM_digest != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy$DM_digest
dairy <- dairy[dairy$DM_digest != na.value  , ]
dairy <- dairy[  dairy$milk_kg_day != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
unq.brdss
breeds.dairy
d <<- read_excel('feed_intake_data+JH.xlsx'
, sheet = 'feed_intake_raw'
, col_types = "text")
na.value <- 'NA'
unq.spcs <- unique(d$Species)
unq.brdss <- unique(d$Variety)
species.cattle <- c(   unq.spcs[3], unq.spcs[9]  )
d <- d[  d$Species %in% species.cattle  , ]
d$Species
d <- data.frame(d)
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
breeds.dairy
unq.brdss
d <<- read_excel('feed_intake_data+JH.xlsx'
, sheet = 'feed_intake_raw'
, col_types = "text")
na.value <- 'NA'
unq.spcs <- unique(d$Species)
unq.brdss <- unique(d$Variety)
unq.spcs <- unique(d$Species)
species.cattle <- c(   unq.spcs[3], unq.spcs[9]  )
unq.brdss <- unique(d$Variety)
unq.brdss
unique(d$Variety)
unq.spcs <- unique(d$Species)
species.cattle <- c(   unq.spcs[3], unq.spcs[9]  )
d <- d[  d$Species %in% species.cattle  , ]
unq.brdss <- unique(d$Variety)
unq.brdss
# -- Dairy
breeds.dairy <- c(
unq.brdss[1]
,  unq.brdss[3]
,  unq.brdss[4]
,  unq.brdss[12]
,  unq.brdss[14]
,  unq.brdss[15]
,  unq.brdss[16]
,  unq.brdss[17]
,  unq.brdss[18]
,  unq.brdss[20]
,  unq.brdss[21]
,  unq.brdss[23]
,  unq.brdss[24]
,  unq.brdss[25]
,  unq.brdss[29]
,  unq.brdss[30]
,  unq.brdss[32]
,  unq.brdss[33]
,  unq.brdss[34]
,  unq.brdss[37]
,  unq.brdss[38]
,  unq.brdss[39]
)
breeds.dairy
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy$DM_digest
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[dairy$DM_digest != na.value  , ]
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
dairy <- d[d$Variety %in% breeds.dairy , ]
dairy <- dairy[  dairy$CP_nutrition != na.value  , ]
dairy <- dairy[  dairy$NDF_nutrition != na.value  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
dairy$bw_kg
# Subsetting based on physiology
dairy <- dairy[  dairy$bw_kg != 'NA'  , ]
length(unique(dairy$B.Code))
length(unique(dairy$A.Level.Name))
