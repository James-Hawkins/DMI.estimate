gg.sheep.compare
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
predict(gt.mod.1.hi.ndf )
predict(gt.mod.2.hi.ndf )
predict(gt.mod.3.hi.ndf )
predict(gt.mod.1.lo.ndf )
predict(gt.mod.2.lo.ndf )
predict(gt.mod.3.lo.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f1.lo.ndf$fitted
goats.cc.f1.low.ndf$fitted
goats.cc.f1.lo.NDF
goats.cc.f1.lo.ndf
goats.cc.f2.hi.NDF$fitted <- predict(gt.mod.1.hi.ndf )
predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.NDF$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f1.lo.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.lo.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.lo.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
gt.mod.2.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f2.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f2.lo.NDF
)
r2_nakagawa(gt.mod.2.lo.ndf)
rmse(gt.mod.2.lo.ndf) / (mean(na.omit(abs(goats.cc.f2.lo.NDF$feeding.level.g.d.kg.bw ) )))
gt.mod.3.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f3.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f3.lo.NDF
)
r2_nakagawa(gt.mod.3.lo.ndf)
rmse(gt.mod.3.lo.ndf) / (mean(na.omit(abs(goats.cc.f3.lo.NDF$feeding.level.g.d.kg.bw ) )))
# High NDF
gt.mod.1.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f1.hi.ndf$T.Animals / mean(na.omit(goats.cc.f1.hi.ndf$T.Animals))
, data = goats.cc.f1.hi.ndf
)
r2_nakagawa(gt.mod.1.hi.ndf)
rmse(gt.mod.1.hi.ndf) / (mean(na.omit(abs(goats.cc.f1.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.2.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f2.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f2.hi.ndf
)
r2_nakagawa(gt.mod.2.hi.ndf)
rmse(gt.mod.2.hi.ndf) / (mean(na.omit(abs(goats.cc.f2.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.3.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f3.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f3.hi.ndf
)
r2_nakagawa(gt.mod.3.hi.ndf)
rmse(gt.mod.3.hi.ndf) / (mean(na.omit(abs(goats.cc.f3.hi.ndf$feeding.level.g.d.kg.bw ) )))
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
mod.sum <- tab_model(
gt.mod.1.lo.ndf
, gt.mod.2.lo.ndf
, gt.mod.3.lo.ndf
, gt.mod.1.hi.ndf
, gt.mod.2.hi.ndf
, gt.mod.3.hi.ndf
, pred.labels = pred.labels.list
,  dv.labels = dv.labels.list
, string.pred = "Coefficient"
#  string.ci = "Conf. Int (95%)"
# string.p = "P-Value"
, file = html.file.name
)
goats.cc.f1.lo.NDF$formula <- 'Equation 1'
goats.cc.f1.lo.NDF$ndf.level <- 'Low NDF'
goats.cc.f1.lo.NDF$species <- species.goat
goats.cc.f2.lo.NDF$formula <- 'Equation 2'
goats.cc.f2.lo.NDF$ndf.level <- 'Low NDF'
goats.cc.f2.lo.NDF$species <- species.goat
goats.cc.f3.lo.NDF$formula <- 'Equation 3'
goats.cc.f3.lo.NDF$ndf.level <- 'Low NDF'
goats.cc.f3.lo.NDF$species <- species.goat
goats.cc.f1.hi.NDF$formula <- 'Equation 1'
goats.cc.f1.hi.NDF$ndf.level <- 'High NDF'
goats.cc.f1.hi.NDF$species <- species.goat
goats.cc.f2.hi.NDF$formula <- 'Equation 2'
goats.cc.f2.hi.NDF$ndf.level <- 'High NDF'
goats.cc.f2.hi.NDF$species <- species.goat
goats.cc.f3.hi.NDF$formula <- 'Equation 3'
goats.cc.f3.hi.NDF$ndf.level <- 'High NDF'
goats.cc.f3.hi.NDF$species <- species.goat
gg.dat.all <- rbind(
goats.cc.f1.lo.NDF
, goats.cc.f2.lo.NDF
, goats.cc.f3.lo.NDF
,  goats.cc.f1.hi.NDF
, goats.cc.f2.hi.NDF
, goats.cc.f3.hi.NDF
)
ggplot( gg.dat.all    ) +
geom_point( aes( x =   feeding.level.g.d.kg.bw, y = fitted        ) , )
ggplot( gg.dat.all    )
gg.dat.all
ggplot( gg.dat.all    ) +
geom_point( aes( x =   feeding.level.g.d.kg.bw, y = fitted        ) , )
predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted
goats.cc.f2.hi.ndf
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
goats.cc.f3.lo.ndf$feeding.level.g.d.kg.bw
goats.cc.f3.lo.ndf$fitted
goats.cc.f1.lo.ndf$formula <- 'Equation 1'
goats.cc.f1.lo.ndf$formula <- 'Equation 1'
goats.cc.f1.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f1.lo.ndf$species <- species.goat
goats.cc.f2.lo.ndf$formula <- 'Equation 2'
goats.cc.f2.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f2.lo.ndf$species <- species.goat
goats.cc.f3.lo.ndf$formula <- 'Equation 3'
goats.cc.f3.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f3.lo.ndf$species <- species.goat
goats.cc.f1.hi.ndf$formula <- 'Equation 1'
goats.cc.f1.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f1.hi.ndf$species <- species.goat
goats.cc.f2.hi.ndf$formula <- 'Equation 2'
goats.cc.f2.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f2.hi.ndf$species <- species.goat
goats.cc.f3.hi.ndf$formula <- 'Equation 3'
goats.cc.f3.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f3.hi.ndf$species <- species.goat
gg.dat.all <- rbind(
goats.cc.f1.lo.ndf
, goats.cc.f2.lo.ndf
, goats.cc.f3.lo.ndf
,  goats.cc.f1.hi.ndf
, goats.cc.f2.hi.ndf
, goats.cc.f3.hi.ndf
)
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
goats.cc.f1 <- goats[complete.cases(goats[,form.1]),]
goats.cc.f2 <- goats[complete.cases(goats[,form.2]),]
goats.cc.f3 <- goats[complete.cases(goats[,form.3]),]
goats.cc.f1.lo.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.lo.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.lo.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
gt.mod.1.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f1.lo.NDF$T.Animals / mean(na.omit(goats.cc.f1.lo.NDF$T.Animals))
, data = goats.cc.f1.lo.NDF
)
r2_nakagawa(gt.mod.1.lo.ndf)
rmse(gt.mod.1.lo.ndf) / (mean(na.omit(abs(goats.cc.f1.lo.NDF$feeding.level.g.d.kg.bw ) )))
gt.mod.2.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f2.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f2.lo.NDF
)
r2_nakagawa(gt.mod.2.lo.ndf)
rmse(gt.mod.2.lo.ndf) / (mean(na.omit(abs(goats.cc.f2.lo.NDF$feeding.level.g.d.kg.bw ) )))
gt.mod.3.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f3.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f3.lo.NDF
)
r2_nakagawa(gt.mod.3.lo.ndf)
rmse(gt.mod.3.lo.ndf) / (mean(na.omit(abs(goats.cc.f3.lo.NDF$feeding.level.g.d.kg.bw ) )))
# High NDF
gt.mod.1.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f1.hi.ndf$T.Animals / mean(na.omit(goats.cc.f1.hi.ndf$T.Animals))
, data = goats.cc.f1.hi.ndf
)
r2_nakagawa(gt.mod.1.hi.ndf)
rmse(gt.mod.1.hi.ndf) / (mean(na.omit(abs(goats.cc.f1.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.2.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f2.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f2.hi.ndf
)
r2_nakagawa(gt.mod.2.hi.ndf)
rmse(gt.mod.2.hi.ndf) / (mean(na.omit(abs(goats.cc.f2.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.3.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f3.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f3.hi.ndf
)
r2_nakagawa(gt.mod.3.hi.ndf)
rmse(gt.mod.3.hi.ndf) / (mean(na.omit(abs(goats.cc.f3.hi.ndf$feeding.level.g.d.kg.bw ) )))
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
goats.cc.f1.lo.ndf$formula <- 'Equation 1'
goats.cc.f1.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f1.lo.ndf$species <- species.goat
goats.cc.f2.lo.ndf$formula <- 'Equation 2'
goats.cc.f2.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f2.lo.ndf$species <- species.goat
goats.cc.f3.lo.ndf$formula <- 'Equation 3'
goats.cc.f3.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f3.lo.ndf$species <- species.goat
goats.cc.f1.hi.ndf$formula <- 'Equation 1'
goats.cc.f1.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f1.hi.ndf$species <- species.goat
goats.cc.f2.hi.ndf$formula <- 'Equation 2'
goats.cc.f2.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f2.hi.ndf$species <- species.goat
goats.cc.f3.hi.ndf$formula <- 'Equation 3'
goats.cc.f3.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f3.hi.ndf$species <- species.goat
gg.dat.all <- rbind(
goats.cc.f1.lo.ndf
, goats.cc.f2.lo.ndf
, goats.cc.f3.lo.ndf
,  goats.cc.f1.hi.ndf
, goats.cc.f2.hi.ndf
, goats.cc.f3.hi.ndf
)
goats.cc.f1.lo.ndf
colnames(goats.cc.f1.lo.ndf)
colnames(goats.cc.f2.lo.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.lo.ndf)
colnames(goats.cc.f2.lo.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f1.hi.ndf)
goats.cc.f1 <- goats[complete.cases(goats[,form.1]),]
goats.cc.f2 <- goats[complete.cases(goats[,form.2]),]
goats.cc.f3 <- goats[complete.cases(goats[,form.3]),]
ndf.thresh.lo <- 300
ndf.thresh.hi <- 600
goats.cc.f1.lo.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.lo.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.lo.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition <= ndf.thresh ,]
goats.cc.f1.hi.ndf <- goats.cc.f1[goats.cc.f1$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition <= ndf.thresh ,]
goats.cc.f2.hi.ndf <- goats.cc.f2[goats.cc.f2$NDF_nutrition >= ndf.thresh.hi ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition <= ndf.thresh ,]
goats.cc.f3.hi.ndf <- goats.cc.f3[goats.cc.f3$NDF_nutrition >= ndf.thresh.hi ,]
gt.mod.1.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f1.lo.NDF$T.Animals / mean(na.omit(goats.cc.f1.lo.NDF$T.Animals))
, data = goats.cc.f1.lo.NDF
)
r2_nakagawa(gt.mod.1.lo.ndf)
rmse(gt.mod.1.lo.ndf) / (mean(na.omit(abs(goats.cc.f1.lo.NDF$feeding.level.g.d.kg.bw ) )))
gt.mod.2.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f2.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f2.lo.NDF
)
r2_nakagawa(gt.mod.2.lo.ndf)
rmse(gt.mod.2.lo.ndf) / (mean(na.omit(abs(goats.cc.f2.lo.NDF$feeding.level.g.d.kg.bw ) )))
gt.mod.3.lo.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.lo.NDF.weight.coef *goats.cc.f3.lo.NDF$T.Animals / mean(na.omit(goats.cc.f2.lo.NDF$T.Animals))
, data = goats.cc.f3.lo.NDF
)
r2_nakagawa(gt.mod.3.lo.ndf)
rmse(gt.mod.3.lo.ndf) / (mean(na.omit(abs(goats.cc.f3.lo.NDF$feeding.level.g.d.kg.bw ) )))
# High NDF
gt.mod.1.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f1.hi.ndf$T.Animals / mean(na.omit(goats.cc.f1.hi.ndf$T.Animals))
, data = goats.cc.f1.hi.ndf
)
r2_nakagawa(gt.mod.1.hi.ndf)
rmse(gt.mod.1.hi.ndf) / (mean(na.omit(abs(goats.cc.f1.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.2.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f2.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f2.hi.ndf
)
r2_nakagawa(gt.mod.2.hi.ndf)
rmse(gt.mod.2.hi.ndf) / (mean(na.omit(abs(goats.cc.f2.hi.ndf$feeding.level.g.d.kg.bw ) )))
gt.mod.3.hi.ndf <- lmer(
feeding.level.g.d.kg.bw ~
bw_kg
+ adg_g_day
+ CP_nutrition
+ NDF_nutrition
+ EE_nutrition
+ Ash_nutrition
+ (
1
| B.Code)
, weights = goats.cc.hi.ndf.weight.coef *goats.cc.f3.hi.ndf$T.Animals / mean(na.omit(goats.cc.f2.hi.ndf$T.Animals))
, data = goats.cc.f3.hi.ndf
)
r2_nakagawa(gt.mod.3.hi.ndf)
rmse(gt.mod.3.hi.ndf) / (mean(na.omit(abs(goats.cc.f3.hi.ndf$feeding.level.g.d.kg.bw ) )))
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
goats.cc.f2.hi.ndf$fitted <- predict(gt.mod.2.hi.ndf )
goats.cc.f3.hi.ndf$fitted <- predict(gt.mod.3.hi.ndf )
goats.cc.f1.lo.ndf$fitted <- predict(gt.mod.1.lo.ndf )
goats.cc.f2.lo.ndf$fitted <- predict(gt.mod.2.lo.ndf )
goats.cc.f3.lo.ndf$fitted <- predict(gt.mod.3.lo.ndf )
goats.cc.f1.lo.ndf$formula <- 'Equation 1'
goats.cc.f1.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f1.lo.ndf$species <- species.goat
goats.cc.f2.lo.ndf$formula <- 'Equation 2'
goats.cc.f2.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f2.lo.ndf$species <- species.goat
goats.cc.f3.lo.ndf$formula <- 'Equation 3'
goats.cc.f3.lo.ndf$ndf.level <- 'Low NDF'
goats.cc.f3.lo.ndf$species <- species.goat
goats.cc.f1.hi.ndf$formula <- 'Equation 1'
goats.cc.f1.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f1.hi.ndf$species <- species.goat
goats.cc.f2.hi.ndf$formula <- 'Equation 2'
goats.cc.f2.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f2.hi.ndf$species <- species.goat
goats.cc.f3.hi.ndf$formula <- 'Equation 3'
goats.cc.f3.hi.ndf$ndf.level <- 'High NDF'
goats.cc.f3.hi.ndf$species <- species.goat
colnames(goats.cc.f1.lo.ndf)
colnames(goats.cc.f2.lo.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f1.lo.ndf)
colnames(goats.cc.f2.lo.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f2.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
colnames(goats.cc.f3.lo.ndf)
colnames(goats.cc.f1.hi.ndf)
goats.cc.f1.hi.ndf$fitted <- predict(gt.mod.1.hi.ndf )
gg.dat.all <- rbind(
goats.cc.f1.lo.ndf
, goats.cc.f2.lo.ndf
, goats.cc.f3.lo.ndf
,  goats.cc.f1.hi.ndf
, goats.cc.f2.hi.ndf
, goats.cc.f3.hi.ndf
)
ggplot( gg.dat.all    ) +
geom_point( aes( x =   feeding.level.g.d.kg.bw, y = fitted        ) , )
ggplot( gg.dat.all    ) +
geom_point( aes( x =   feeding.level.g.d.kg.bw, y = fitted        ) , ) +
geom_line(aes(x = feeding.level.g.d.kg.bw , y = feeding.level.g.d.kg.bw)) +
facet_grid( ~   species + formula + ndf.level , scales = 'fixed')
save.image('dmi.estimate.RData')
